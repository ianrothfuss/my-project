"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1710],{31710:(e,l,a)=>{a.r(l),a.d(l,{UploadComponent:()=>_});var t=a(9288),o=a(71697),n=a(27162),i=a(7442),s=a(93495),c=a(12298),d=a(79870),r=a(37415),u=a(30207),m=a(46771),h=a(18019),p=a(65165),g=a(91949),b=a(3391),v="lexical-upload",f={depth:0},_=e=>{var l,a,_,w;let{data:{fields:x,relationTo:j,value:D},nodeKey:N}=e;if("object"==typeof D)throw Error("Upload value should be a string or number. The Lexical Upload component should not receive the populated value object.");let{config:{routes:{api:C},serverURL:S},getEntityConfig:y}=(0,u.b)(),k=(0,b.useRef)(null),{uuid:P}=(0,i.b)(),U=(0,m.useEditDepth)(),[E]=(0,c.DF)(),{editorConfig:T,fieldProps:{schemaPath:z}}=(0,i.b)(),B=(0,d.a)(),{i18n:L,t:R}=(0,h.d)(),[F,K]=(0,b.useReducer)(e=>e+1,0),[I]=(0,b.useState)(()=>y({collectionSlug:j})),A=(0,b.useId)(),M=(0,m.formatDrawerSlug)({slug:"lexical-upload-drawer-"+P+A,depth:U}),{toggleDrawer:O}=(0,o.a)(M,!0),{closeDocumentDrawer:q,DocumentDrawer:G,DocumentDrawerToggler:H}=(0,n.a)({id:D,collectionSlug:I.slug}),[{data:J},{setParams:Q}]=(0,m.usePayloadAPI)("".concat(S).concat(C,"/").concat(I.slug,"/").concat(D),{initialParams:f}),V=(null==J?void 0:J.thumbnailURL)||(null==J?void 0:J.url),W=(0,b.useCallback)(()=>{E.update(()=>{var e;null==(e=(0,p.nsf)(N))||e.remove()})},[E,N]),X=(0,b.useCallback)(e=>{Q({...f,cacheBust:F}),K(),q()},[Q,F,q]),Y=null==T||null==(w=T.resolvedFeatureMap)||null==(_=w.get("upload"))||null==(a=_.sanitizedClientFeatureProps.collections)||null==(l=a[I.slug])?void 0:l.hasExtraFields,Z=(0,b.useCallback)((e,l)=>{E.update(()=>{let e=(0,p.nsf)(N);if(e){let a={...e.getData(),fields:l};e.setData(a)}})},[E,N]),$=V&&(null==J?void 0:J.width)&&(null==J?void 0:J.height)?J.width>J.height?"landscape":"portrait":"landscape";return(0,s.jsxs)("div",{className:"".concat(v," ").concat(v,"--").concat($),"data-filename":null==J?void 0:J.filename,ref:k,children:[(0,s.jsxs)("div",{className:"".concat(v,"__card"),children:[(0,s.jsxs)("div",{className:"".concat(v,"__media"),children:[(0,s.jsx)(m.Thumbnail,{collectionSlug:j,fileSrc:(0,g.w)(null==J?void 0:J.mimeType)?V:null,height:null==J?void 0:J.height,size:"none",width:null==J?void 0:J.width}),B&&(0,s.jsx)("div",{className:"".concat(v,"__overlay ").concat(v,"__floater"),children:(0,s.jsxs)("div",{className:"".concat(v,"__actions"),role:"toolbar",children:[Y?(0,s.jsx)(m.Button,{buttonStyle:"icon-label",className:"".concat(v,"__upload-drawer-toggler"),disabled:!B,el:"button",icon:"edit",onClick:O,round:!0,size:"medium",tooltip:R("fields:editRelationship")}):null,(0,s.jsx)(m.Button,{buttonStyle:"icon-label",className:"".concat(v,"__swap-drawer-toggler"),disabled:!B,el:"button",icon:"swap",onClick:()=>{E.dispatchCommand(t.b,{replace:{nodeKey:N}})},round:!0,size:"medium",tooltip:R("fields:swapUpload")}),(0,s.jsx)(m.Button,{buttonStyle:"icon-label",className:"".concat(v,"__removeButton"),disabled:!B,icon:"x",onClick:e=>{e.preventDefault(),W()},round:!0,size:"medium",tooltip:R("fields:removeUpload")})]})})]}),(0,s.jsxs)("div",{className:"".concat(v,"__metaOverlay ").concat(v,"__floater"),children:[(0,s.jsx)(H,{className:"".concat(v,"__doc-drawer-toggler"),children:(0,s.jsx)("strong",{className:"".concat(v,"__filename"),children:(null==J?void 0:J.filename)||R("general:untitled")})}),(0,s.jsx)("div",{className:"".concat(v,"__collectionLabel"),children:(0,r.s)(I.labels.singular,L)})]})]}),D?(0,s.jsx)(G,{onSave:X}):null,Y?(0,s.jsx)(t.a,{data:x,drawerSlug:M,drawerTitle:R("general:editLabel",{label:(0,r.s)(I.labels.singular,L)}),featureKey:"upload",handleDrawerSubmit:Z,schemaPath:z,schemaPathSuffix:I.slug}):null]})}}}]);