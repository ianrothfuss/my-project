"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2661],{888:(e,t,a)=>{a.d(t,{AccountClient:()=>s});var i=a(89057),n=a(46771),l=a(18019),r=a(3391);let s=()=>{let e,t,a=(0,i.c)(4),{setStepNav:s}=(0,n.useStepNav)(),{t:o}=(0,l.d)();return a[0]!==s||a[1]!==o?(e=()=>{let e=[];e.push({label:o("authentication:account"),url:"/account"}),s(e)},t=[s,o],a[0]=s,a[1]=o,a[2]=e,a[3]=t):(e=a[2],t=a[3]),r.useEffect(e,t),null}},12042:(e,t,a)=>{a.d(t,{CreateFirstUserClient:()=>u});var i=a(93495),n=a(30207),l=a(46771),r=a(18019),s=a(69593),o=a(3391);let u=e=>{let{docPermissions:t,docPreferences:a,initialState:u,loginWithUsername:c,userSlug:d}=e,{config:{routes:{admin:m,api:h},serverURL:p},getEntityConfig:f}=(0,n.b)(),{getFormState:g}=(0,l.useServerFunctions)(),{t:v}=(0,r.d)(),{setUser:w}=(0,l.useAuth)(),x=o.useRef(null),j=f({collectionSlug:d}),b=o.useCallback(async e=>{let{formState:i,submitted:n}=e,l=(0,s.wN)(x),r=await g({collectionSlug:d,docPermissions:t,docPreferences:a,formState:i,operation:"create",schemaPath:d,signal:l.signal,skipValidation:!n});if(x.current=null,r&&r.state)return r.state},[d,g,t,a]);return(0,o.useEffect)(()=>{let e=x.current;return()=>{(0,s.eS)(e)}},[]),(0,i.jsxs)(l.Form,{action:"".concat(p).concat(h,"/").concat(d,"/first-register"),initialState:{...u,"confirm-password":{...u["confirm-password"],valid:u["confirm-password"].valid||!1,value:u["confirm-password"].value||""}},method:"POST",onChange:[b],onSuccess:e=>{w(e)},redirect:m,validationOperation:"create",children:[(0,i.jsx)(l.EmailAndUsernameFields,{className:"emailAndUsername",loginWithUsername:c,operation:"create",readOnly:!1,t:v}),(0,i.jsx)(l.PasswordField,{autoComplete:"off",field:{name:"password",label:v("authentication:newPassword"),required:!0},path:"password"}),(0,i.jsx)(l.ConfirmPasswordField,{}),(0,i.jsx)(l.RenderFields,{fields:j.fields,forceRender:!0,parentIndexPath:"",parentPath:"",parentSchemaPath:d,permissions:!0,readOnly:!1}),(0,i.jsx)(l.FormSubmit,{size:"large",children:v("general:create")})]})}},35872:(e,t,a)=>{a.d(t,{ToastAndRedirect:()=>s});var i=a(89057),n=a(46771),l=a(49464),r=a(3391);function s(e){let t,a,s=(0,i.c)(6),{message:o,redirectTo:u}=e,c=(0,l.useRouter)(),{startRouteTransition:d}=(0,n.useRouteTransition)(),m=r.useRef(!1);return s[0]!==o||s[1]!==u||s[2]!==c||s[3]!==d?(t=()=>{let e;return n.toast&&(e=setTimeout(()=>{n.toast.success(o),m.current=!0,d(()=>c.push(u))},100)),()=>{e&&clearTimeout(e)}},a=[c,u,o,d],s[0]=o,s[1]=u,s[2]=c,s[3]=d,s[4]=t,s[5]=a):(t=s[4],a=s[5]),(0,r.useEffect)(t,a),null}},53050:(e,t,a)=>{a.d(t,{ForgotPasswordForm:()=>d});var i=a(89057),n=a(93495),l=a(30207),r=a(18019),s=a(46771),o=a(17615),u=a(3391);function c({description:e,heading:t}){return t?(0,n.jsxs)("div",{className:"form-header",children:[(0,n.jsx)("h1",{children:t}),!!e&&(0,n.jsx)("p",{children:e})]}):null}let d=()=>{var e;let t,a,d,m,h=(0,i.c)(17),{config:p,getEntityConfig:f}=(0,l.b)(),{admin:g,routes:v}=p,{user:w}=g,{api:x}=v,{t:j}=(0,r.d)(),[b,S]=(0,u.useState)(!1);h[0]!==f||h[1]!==w?(t=f({collectionSlug:w}),h[0]=f,h[1]=w,h[2]=t):t=h[2];let F=t,y=null==F||null==(e=F.auth)?void 0:e.loginWithUsername;h[3]!==y||h[4]!==j?(a=(e,t,a)=>{e.json().then(()=>{S(!0),t(j("general:submissionSuccessful"))}).catch(()=>{a(y?j("authentication:usernameNotValid"):j("authentication:emailNotValid"))})},h[3]=y,h[4]=j,h[5]=a):a=h[5];let P=a;if(h[6]!==x||h[7]!==p||h[8]!==P||h[9]!==b||h[10]!==y||h[11]!==j||h[12]!==w){m=Symbol.for("react.early_return_sentinel");e:{let e=y?{username:{initialValue:"",valid:!0,value:void 0}}:{email:{initialValue:"",valid:!0,value:void 0}};if(b){let e;h[15]!==j?(e=(0,n.jsx)(c,{description:j("authentication:checkYourEmailForPasswordReset"),heading:j("authentication:emailSent")}),h[15]=j,h[16]=e):e=h[16],m=e;break e}d=(0,n.jsxs)(s.Form,{action:"".concat(x,"/").concat(w,"/forgot-password"),handleResponse:P,initialState:e,method:"POST",children:[(0,n.jsx)(c,{description:y?j("authentication:forgotPasswordUsernameInstructions"):j("authentication:forgotPasswordEmailInstructions"),heading:j("authentication:forgotPassword")}),y?(0,n.jsx)(s.TextField,{field:{name:"username",label:j("authentication:username"),required:!0},path:"username",validate:e=>(0,o.Qq)(e,{name:"username",type:"text",blockData:{},data:{},event:"onChange",path:["username"],preferences:{fields:{}},req:{payload:{config:p},t:j},required:!0,siblingData:{}})}):(0,n.jsx)(s.EmailField,{field:{name:"email",admin:{autoComplete:"email"},label:j("general:email"),required:!0},path:"email",validate:e=>(0,o.Rp)(e,{name:"email",type:"email",blockData:{},data:{},event:"onChange",path:["email"],preferences:{fields:{}},req:{payload:{config:p},t:j},required:!0,siblingData:{}})}),(0,n.jsx)(s.FormSubmit,{size:"large",children:j("general:submit")})]})}h[6]=x,h[7]=p,h[8]=P,h[9]=b,h[10]=y,h[11]=j,h[12]=w,h[13]=d,h[14]=m}else d=h[13],m=h[14];return m!==Symbol.for("react.early_return_sentinel")?m:d}},61289:(e,t,a)=>{a.d(t,{ResetPreferences:()=>c});var i=a(89057),n=a(93495),l=a(46771),r=a(18019),s=a(38079),o=a(3391);let u="confirm-reset-modal",c=e=>{let t,a,c,d=(0,i.c)(9),{apiRoute:m,user:h}=e,{openModal:p}=(0,l.useModal)(),{t:f}=(0,r.d)();d[0]!==m||d[1]!==h?(t=async()=>{if(!h)return;let e=s.A({depth:0,where:{user:{id:{equals:h.id}}}},{addQueryPrefix:!0});try{let t=await fetch("".concat(m,"/payload-preferences").concat(e),{credentials:"include",headers:{"Content-Type":"application/json"},method:"DELETE"}),a=(await t.json()).message;t.ok?l.toast.success(a):l.toast.error(a)}catch(e){}},d[0]=m,d[1]=h,d[2]=t):t=d[2];let g=t;return d[3]!==p?(a=()=>p(u),d[3]=p,d[4]=a):a=d[4],d[5]!==g||d[6]!==f||d[7]!==a?(c=(0,n.jsxs)(o.Fragment,{children:[(0,n.jsx)("div",{children:(0,n.jsx)(l.Button,{buttonStyle:"secondary",onClick:a,children:f("general:resetPreferences")})}),(0,n.jsx)(l.ConfirmationModal,{body:f("general:resetPreferencesDescription"),confirmingLabel:f("general:resettingPreferences"),heading:f("general:resetPreferences"),modalSlug:u,onConfirm:g})]}),d[5]=g,d[6]=f,d[7]=a,d[8]=c):c=d[8],c}},64221:(e,t,a)=>{a.d(t,{LogoutClient:()=>c});var i=a(89057),n=a(93495),l=a(46771),r=a(18019),s=a(49464),o=a(31641),u=a(3391);let c=e=>{let t,a,c,d,m,h=(0,i.c)(23),{adminRoute:p,inactivity:f,redirect:g}=e,{logOut:v,user:w}=(0,l.useAuth)(),{startRouteTransition:x}=(0,l.useRouteTransition)();null==w||w.id;let j=!!(null==w?void 0:w.id),b=u.useRef(!1);h[0]!==p||h[1]!==f||h[2]!==g?(t=()=>(0,o.Q)({adminRoute:p,path:"/login".concat(f&&g&&g.length>0?"?redirect=".concat(encodeURIComponent(g)):"")}),h[0]=p,h[1]=f,h[2]=g,h[3]=t):t=h[3];let[S]=u.useState(t),{t:F}=(0,r.d)(),y=(0,s.useRouter)();h[4]!==f||h[5]!==v||h[6]!==S||h[7]!==y||h[8]!==x||h[9]!==F?(a=async()=>{if(!f&&!b.current){b.current=!0,await v(),l.toast.success(F("authentication:loggedOutSuccessfully")),x(()=>y.push(S));return}},h[4]=f,h[5]=v,h[6]=S,h[7]=y,h[8]=x,h[9]=F,h[10]=a):a=h[10];let P=a;if(h[11]!==P||h[12]!==j||h[13]!==S||h[14]!==y||h[15]!==x?(c=()=>{j?P():b.current||(b.current=!0,x(()=>y.push(S)))},d=[P,j,S,y,x],h[11]=P,h[12]=j,h[13]=S,h[14]=y,h[15]=x,h[16]=c,h[17]=d):(c=h[16],d=h[17]),(0,u.useEffect)(c,d),!j&&f){let e;return h[18]!==S||h[19]!==F?(e=(0,n.jsxs)("div",{className:"".concat("logout","__wrap"),children:[(0,n.jsx)("h2",{children:F("authentication:loggedOutInactivity")}),(0,n.jsx)(l.Button,{buttonStyle:"secondary",el:"link",size:"large",url:S,children:F("authentication:logBackIn")})]}),h[18]=S,h[19]=F,h[20]=e):e=h[20],e}return h[21]!==F?(m=(0,n.jsx)(l.LoadingOverlay,{animationDuration:"0ms",loadingText:F("authentication:loggingOut")}),h[21]=F,h[22]=m):m=h[22],m}},69025:(e,t,a)=>{a.d(t,{ResetPasswordForm:()=>c});var i=a(89057),n=a(93495),l=a(18019),r=a(30207),s=a(46771),o=a(49464),u=a(31641);a(3391);let c=e=>{let t,a,c=(0,i.c)(12),{token:d}=e,m=(0,l.d)(),{config:h}=(0,r.b)(),{admin:p,routes:f,serverURL:g}=h,{routes:v,user:w}=p,{login:x}=v,{admin:j,api:b}=f,S=(0,o.useRouter)(),{fetchFullUser:F}=(0,s.useAuth)();c[0]!==j||c[1]!==F||c[2]!==S||c[3]!==x?(t=async()=>{await F()?S.push(j):S.push((0,u.Q)({adminRoute:j,path:x}))},c[0]=j,c[1]=F,c[2]=S,c[3]=x,c[4]=t):t=c[4];let y=t;return c[5]!==b||c[6]!==m||c[7]!==y||c[8]!==g||c[9]!==d||c[10]!==w?(a=(0,n.jsxs)(s.Form,{action:"".concat(g).concat(b,"/").concat(w,"/reset-password"),initialState:{"confirm-password":{initialValue:"",valid:!1,value:""},password:{initialValue:"",valid:!1,value:""},token:{initialValue:d,valid:!0,value:d}},method:"POST",onSuccess:y,children:[(0,n.jsxs)("div",{className:"inputWrap",children:[(0,n.jsx)(s.PasswordField,{field:{name:"password",label:m.t("authentication:newPassword"),required:!0},path:"password",schemaPath:"".concat(w,".password")}),(0,n.jsx)(s.ConfirmPasswordField,{}),(0,n.jsx)(s.HiddenField,{path:"token",schemaPath:"".concat(w,".token"),value:d})]}),(0,n.jsx)(s.FormSubmit,{size:"large",children:m.t("authentication:resetPassword")})]}),c[5]=b,c[6]=m,c[7]=y,c[8]=g,c[9]=d,c[10]=w,c[11]=a):a=c[11],a}},78086:(e,t,a)=>{a.d(t,{LoginForm:()=>h});var i=a(89057),n=a(93495),l=a(3391),r=a(30207),s=a(18019),o=a(46771),u=a(31641),c=a(17615);let d=e=>{let t=(0,i.c)(11),{type:a,required:l}=e,r=void 0===l||l,{t:u}=(0,s.d)();if("email"===a){let e;return t[0]!==r||t[1]!==u?(e=(0,n.jsx)(o.EmailField,{field:{name:"email",admin:{autoComplete:"email"},label:u("general:email"),required:r},path:"email",validate:c.Rp}),t[0]=r,t[1]=u,t[2]=e):e=t[2],e}if("username"===a){let e;return t[3]!==r||t[4]!==u?(e=(0,n.jsx)(o.TextField,{field:{name:"username",label:u("authentication:username"),required:r},path:"username",validate:c.Xh}),t[3]=r,t[4]=u,t[5]=e):e=t[5],e}if("emailOrUsername"===a){let e;if(t[6]!==r||t[7]!==u){let a;t[9]!==u?(a=(e,t)=>{let a=(0,c.Xh)(e,t),i=(0,c.Rp)(e,t);return!!i||!!a||"".concat(u("general:email"),": ").concat(i," ").concat(u("general:username"),": ").concat(a)},t[9]=u,t[10]=a):a=t[10],e=(0,n.jsx)(o.TextField,{field:{name:"username",label:u("authentication:emailOrUsername"),required:r},path:"username",validate:a}),t[6]=r,t[7]=u,t[8]=e}else e=t[8];return e}return null},m="login__form",h=e=>{let t,a,c,h,p=(0,i.c)(23),{prefillEmail:f,prefillPassword:g,prefillUsername:v,searchParams:w}=e,{config:x,getEntityConfig:j}=(0,r.b)(),{admin:b,routes:S}=x,{routes:F,user:y}=b,{forgot:P}=F,{admin:C,api:k}=S;if(p[0]!==j||p[1]!==y){let{auth:e}=j({collectionSlug:y});a=(e=>({canLoginWithEmail:!e||e.allowEmailLogin,canLoginWithUsername:!!e}))(t=e.loginWithUsername),p[0]=j,p[1]=y,p[2]=t,p[3]=a}else t=p[2],a=p[3];let{canLoginWithEmail:R,canLoginWithUsername:T}=a;p[4]!==R||p[5]!==T?(c=()=>R&&T?"emailOrUsername":T?"username":"email",p[4]=R,p[5]=T,p[6]=c):c=p[6];let[E]=l.useState(c),{t:W}=(0,s.d)(),{setUser:O}=(0,o.useAuth)(),_=null!=g?g:void 0,U=null!=g?g:void 0;if(p[7]!==C||p[8]!==k||p[9]!==P||p[10]!==E||p[11]!==t||p[12]!==f||p[13]!==v||p[14]!==(null==w?void 0:w.redirect)||p[15]!==O||p[16]!==W||p[17]!==_||p[18]!==U||p[19]!==y){let e,a={password:{initialValue:_,valid:!0,value:U}};t?a.username={initialValue:null!=v?v:void 0,valid:!0,value:null!=v?v:void 0}:a.email={initialValue:null!=f?f:void 0,valid:!0,value:null!=f?f:void 0},p[21]!==O?(e=e=>{O(e)},p[21]=O,p[22]=e):e=p[22];let i=e;h=(0,n.jsxs)(o.Form,{action:"".concat(k,"/").concat(y,"/login"),className:m,disableSuccessStatus:!0,initialState:a,method:"POST",onSuccess:i,redirect:(({allowAbsoluteUrls:e=!1,fallbackTo:t="/",redirectTo:a})=>{let i;if("string"!=typeof a)return t;try{i=decodeURIComponent(a.trim())}catch{return t}let n=i.startsWith("/")&&!i.startsWith("//")&&!i.startsWith("/%2F")&&!i.startsWith("/\\/")&&!i.startsWith("/\\\\")&&!i.startsWith("/\\")&&!i.toLowerCase().startsWith("/javascript:")&&!i.toLowerCase().startsWith("/http"),l=e&&/^https?:\/\/\S+$/i.test(i);return n||l?i:t})({fallbackTo:C,redirectTo:null==w?void 0:w.redirect}),waitForAutocomplete:!0,children:[(0,n.jsxs)("div",{className:"".concat(m,"__inputWrap"),children:[(0,n.jsx)(d,{type:E}),(0,n.jsx)(o.PasswordField,{field:{name:"password",label:W("general:password"),required:!0},path:"password"})]}),(0,n.jsx)(o.Link,{href:(0,u.Q)({adminRoute:C,path:P}),prefetch:!1,children:W("authentication:forgotPasswordQuestion")}),(0,n.jsx)(o.FormSubmit,{size:"large",children:W("authentication:login")})]}),p[7]=C,p[8]=k,p[9]=P,p[10]=E,p[11]=t,p[12]=f,p[13]=v,p[14]=null==w?void 0:w.redirect,p[15]=O,p[16]=W,p[17]=_,p[18]=U,p[19]=y,p[20]=h}else h=p[20];return h}},96978:(e,t,a)=>{a.d(t,{LanguageSelector:()=>s});var i=a(89057),n=a(93495),l=a(18019),r=a(46771);a(3391);let s=e=>{let t,a,s=(0,i.c)(8),{languageOptions:o}=e,{i18n:u,switchLanguage:c}=(0,l.d)();if(s[0]!==c?(t=async e=>{await c(e.value)},s[0]=c,s[1]=t):t=s[1],s[2]!==u||s[3]!==o||s[4]!==t){let e;s[6]!==u?(e=e=>e.value===u.language,s[6]=u,s[7]=e):e=s[7],a=(0,n.jsx)(r.ReactSelect,{inputId:"language-select",isClearable:!1,onChange:t,options:o,value:o.find(e)}),s[2]=u,s[3]=o,s[4]=t,s[5]=a}else a=s[5];return a}},97921:(e,t,a)=>{a.d(t,{ToggleTheme:()=>o});var i=a(89057),n=a(93495),l=a(30207),r=a(18019),s=a(46771);a(3391);let o=()=>{let e,t,a=(0,i.c)(7),{autoMode:o,setTheme:u,theme:c}=(0,l.i)(),{t:d}=(0,r.d)();a[0]!==u?(e=e=>{u(e)},a[0]=u,a[1]=e):e=a[1];let m=e;return a[2]!==o||a[3]!==m||a[4]!==d||a[5]!==c?(t=(0,n.jsx)(s.RadioGroupField,{disableModifyingForm:!0,field:{name:"theme",label:d("general:adminTheme"),options:[{label:d("general:automatic"),value:"auto"},{label:d("general:light"),value:"light"},{label:d("general:dark"),value:"dark"}]},onChange:m,path:"theme",value:o?"auto":c}),a[2]=o,a[3]=m,a[4]=d,a[5]=c,a[6]=t):t=a[6],t}}}]);