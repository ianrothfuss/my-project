(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4906],{21694:(e,r,t)=>{"use strict";t.d(r,{LogoutPage:()=>i});var o=t(93495),a=t(63044),l=t(42919),s=t.n(l),n=t(3391);let i=e=>{let{logout:r}=(0,a.A)(),[t,l]=(0,n.useState)(""),[i,c]=(0,n.useState)("");return(0,n.useEffect)(()=>{(async()=>{try{await r(),l("Logged out successfully.")}catch(e){c("You are already logged out.")}})()},[r]),(0,o.jsx)(n.Fragment,{children:(i||t)&&(0,o.jsxs)("div",{className:"prose dark:prose-invert",children:[(0,o.jsx)("h1",{children:i||t}),(0,o.jsxs)("p",{children:["What would you like to do next?",(0,o.jsxs)(n.Fragment,{children:[" ",(0,o.jsx)(s(),{href:"/search",children:"Click here"})," to shop."]})," To log back in, ",(0,o.jsx)(s(),{href:"/login",children:"click here"}),"."]})]})})}},63044:(e,r,t)=>{"use strict";t.d(r,{A:()=>n,AuthProvider:()=>s});var o=t(93495),a=t(3391);let l=(0,a.createContext)({}),s=e=>{let{children:r}=e,[t,s]=(0,a.useState)(),[n,i]=(0,a.useState)(),c=(0,a.useCallback)(async e=>{try{let t=await fetch("".concat("http://localhost:3000","/api/users/create"),{body:JSON.stringify({email:e.email,password:e.password,passwordConfirm:e.passwordConfirm}),credentials:"include",headers:{"Content-Type":"application/json"},method:"POST"});if(t.ok){var r;let{data:e,errors:o}=await t.json();if(o)throw Error(o[0].message);s(null==e||null==(r=e.loginUser)?void 0:r.user),i("loggedIn")}else throw Error("Invalid login")}catch(e){throw Error("An error occurred while attempting to login.")}},[]),h=(0,a.useCallback)(async e=>{try{let r=await fetch("".concat("http://localhost:3000","/api/users/login"),{body:JSON.stringify({email:e.email,password:e.password}),credentials:"include",headers:{"Content-Type":"application/json"},method:"POST"});if(r.ok){let{errors:e,user:t}=await r.json();if(e)throw Error(e[0].message);return s(t),i("loggedIn"),t}throw Error("Invalid login")}catch(e){throw Error("An error occurred while attempting to login.")}},[]),d=(0,a.useCallback)(async()=>{try{if((await fetch("".concat("http://localhost:3000","/api/users/logout"),{credentials:"include",headers:{"Content-Type":"application/json"},method:"POST"})).ok)s(null),i("loggedOut");else throw Error("An error occurred while attempting to logout.")}catch(e){throw Error("An error occurred while attempting to logout.")}},[]);(0,a.useEffect)(()=>{(async()=>{try{let e=await fetch("".concat("http://localhost:3000","/api/users/me"),{credentials:"include",headers:{"Content-Type":"application/json"},method:"GET"});if(e.ok){let{user:r}=await e.json();s(r||null),i(r?"loggedIn":void 0)}else throw Error("An error occurred while fetching your account.")}catch(e){throw s(null),Error("An error occurred while fetching your account.")}})()},[]);let u=(0,a.useCallback)(async e=>{try{let t=await fetch("".concat("http://localhost:3000","/api/users/forgot-password"),{body:JSON.stringify({email:e.email}),credentials:"include",headers:{"Content-Type":"application/json"},method:"POST"});if(t.ok){var r;let{data:e,errors:o}=await t.json();if(o)throw Error(o[0].message);s(null==e||null==(r=e.loginUser)?void 0:r.user)}else throw Error("Invalid login")}catch(e){throw Error("An error occurred while attempting to login.")}},[]),p=(0,a.useCallback)(async e=>{try{let o=await fetch("".concat("http://localhost:3000","/api/users/reset-password"),{body:JSON.stringify({password:e.password,passwordConfirm:e.passwordConfirm,token:e.token}),credentials:"include",headers:{"Content-Type":"application/json"},method:"POST"});if(o.ok){var r,t;let{data:e,errors:a}=await o.json();if(a)throw Error(a[0].message);s(null==e||null==(r=e.loginUser)?void 0:r.user),i((null==e||null==(t=e.loginUser)?void 0:t.user)?"loggedIn":void 0)}else throw Error("Invalid login")}catch(e){throw Error("An error occurred while attempting to login.")}},[]);return(0,o.jsx)(l.Provider,{value:{create:c,forgotPassword:u,login:h,logout:d,resetPassword:p,setUser:s,status:n,user:t},children:r})},n=()=>(0,a.useContext)(l)},85104:(e,r,t)=>{Promise.resolve().then(t.bind(t,21694))}},e=>{e.O(0,[2919,659,1263,7358],()=>e(e.s=85104)),_N_E=e.O()}]);